{"ast":null,"code":"import _toConsumableArray from\"C:/Users/i7/Desktop/ReactWeb/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/i7/Desktop/ReactWeb/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/i7/Desktop/ReactWeb/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/i7/Desktop/ReactWeb/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useContext,useEffect,useState}from'react';import{GlobalState}from\"../../../GlobalState\";import axios from'axios';import Payment from\"./Payment\";import{MdErrorOutline}from\"react-icons/md\";function Cart(){var state=useContext(GlobalState);var _state$userAPI$cart=_slicedToArray(state.userAPI.cart,2),cart=_state$userAPI$cart[0],setCart=_state$userAPI$cart[1];var _state$userAPI$isLogg=_slicedToArray(state.userAPI.isLogged,1),isLogged=_state$userAPI$isLogg[0];var user=state.userAPI.user;var _state$token=_slicedToArray(state.token,1),token=_state$token[0];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),total=_useState2[0],setTotal=_useState2[1];useEffect(function(){var getTotal=function getTotal(){var total=cart.reduce(function(prev,item){return prev+item.price*item.quantity;},0);setTotal(total);};getTotal();},[cart]);var addToCart=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(cart){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.patch('https://foodaa-app.herokuapp.com/api/user/addcart',{user:user,cart:cart},{headers:{Authorization:token}});case 2:case\"end\":return _context.stop();}}},_callee);}));return function addToCart(_x){return _ref.apply(this,arguments);};}();var removeProduct=function removeProduct(id){if(window.confirm(\"Do you want to delete this product?\")){cart.forEach(function(item,index){if(item._id===id){cart.splice(index,1);}});setCart(_toConsumableArray(cart));addToCart(cart);}};var increment=function increment(id){cart.forEach(function(item){if(item._id===id){item.quantity+=1;}});setCart(_toConsumableArray(cart));addToCart(cart);};var decrement=function decrement(id){cart.forEach(function(item){if(item._id===id){item.quantity===1?item.quantity=1:item.quantity-=1;}});setCart(_toConsumableArray(cart));addToCart(cart);};var tranSuccess=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(payment){var paymentID,address;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:paymentID=payment.paymentID,address=payment.address;_context2.next=3;return axios.post('https://foodaa-app.herokuapp.com/api/payment/createPayments',{user:user,cart:cart,paymentID:paymentID,address:address},{headers:{Authorization:token}});case 3:setCart([]);addToCart([]);alert(\"You have successfully placed an order.\");case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function tranSuccess(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"w-4/5 m-auto mt-10 flex flex-col md:w-3/4 md:m-auto md:grid md:grid-cols-3 md:gap-4\",children:isLogged?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-span-2  mt-4\",children:cart.map(function(product){return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white-300 w-full h-72 mb-1 shadow-md rounded-md md:mb-2 md:grid md:grid-cols-4 md:h-36 md:w-full  md:col-span-1 \",children:[/*#__PURE__*/_jsx(\"div\",{className:\" h-42 w-full \",children:/*#__PURE__*/_jsx(\"img\",{className:\"h-36 border-4 w-full border-black\",src:product.images.url,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\" h-28 md:col-span-3 pl-5 flex flex-col overflow-hidden md:h-full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\" h-24 truncate mt-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"uppercase text-xl font-bold\",children:product.title}),/*#__PURE__*/_jsxs(\"h1\",{className:\"uppercase text-md font-semibold\",children:[\"PHP \",product.price,\".00\"]}),/*#__PURE__*/_jsx(\"h1\",{className:\"uppercase text-xs \",children:product.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"h-10 flex items-center justify-between w-full md:mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\" flex space-x-1 items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bg-white align-middle inline-block h-full px-2 cursor-pointer border-2 hover:border-black rounded-md\",onClick:function onClick(){return increment(product._id);},children:\" + \"}),/*#__PURE__*/_jsx(\"input\",{className:\"w-10 m-auto focus:outline-none cursor-not-allowed border-2 text-right  \",type:\"number\",value:product.quantity,readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"bg-white align-middle inline-block h-full px-2 cursor-pointer border-2 hover:border-black rounded-md\",onClick:function onClick(){return decrement(product._id);},children:\" - \"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mr-5\",children:/*#__PURE__*/_jsx(\"button\",{className:\"bg-red-400 p-2 uppercase text-sm  font-semibold tracking-wider rounded-sm hover:bg-gray-200 transition ease-out duration-200\",onClick:function onClick(){return removeProduct(product._id);},children:\"Remove\"})})]})]})]},product._id);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white w-full shadow-lg mt-4 h-48 mb-10 sticky grid grid-rows-4 md:h-64 rounded-xl\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center bg-gray-300 \",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-lg font-bold uppercase tracking-widest\",children:\"Order Summary\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between m-10 bg-red-300 \",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-md tracking-wider font-semibold\",children:\"Subtotal Purchase :\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-bold\",children:[\"PHP \",total,\".00\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between m-10 \",children:[/*#__PURE__*/_jsx(\"span\",{}),/*#__PURE__*/_jsx(Payment,{total:total,tranSuccess:tranSuccess})]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\" col-span-3 flex flex-col justify-center items-center w-full mt-56\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-semibold tracking-widest\",children:\"Please Sign In to continue Shopping ...\"}),/*#__PURE__*/_jsx(MdErrorOutline,{className:\"mt-10 text-9xl\"})]})});}export default Cart;","map":{"version":3,"sources":["C:/Users/i7/Desktop/ReactWeb/client/src/components/mainpages/cart/Cart.js"],"names":["React","useContext","useEffect","useState","GlobalState","axios","Payment","MdErrorOutline","Cart","state","userAPI","cart","setCart","isLogged","user","token","total","setTotal","getTotal","reduce","prev","item","price","quantity","addToCart","patch","headers","Authorization","removeProduct","id","window","confirm","forEach","index","_id","splice","increment","decrement","tranSuccess","payment","paymentID","address","post","alert","map","product","images","url","title","description"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState} from 'react'\r\nimport { GlobalState } from \"../../../GlobalState\";\r\nimport axios from 'axios'\r\nimport Payment from \"./Payment\"\r\nimport { MdErrorOutline } from \"react-icons/md\";\r\nfunction Cart() {\r\n    const state = useContext(GlobalState)\r\n    const [cart, setCart] = state.userAPI.cart\r\n    const [isLogged] = state.userAPI.isLogged\r\n    const user = state.userAPI.user\r\n    const [token] = state.token\r\n    const [total, setTotal] = useState(0)\r\n\r\n    useEffect(() =>{\r\n        const getTotal = () =>{\r\n            const total = cart.reduce((prev, item) => {\r\n                return prev + (item.price * item.quantity)\r\n            },0)\r\n\r\n            setTotal(total)\r\n        }\r\n\r\n        getTotal()\r\n\r\n    },[cart])\r\n\r\n    const addToCart = async (cart) =>{\r\n        await axios.patch('https://foodaa-app.herokuapp.com/api/user/addcart', {user:user,cart}, {\r\n            headers: {Authorization: token}\r\n        })\r\n    }\r\n    const removeProduct = id =>{\r\n        if(window.confirm(\"Do you want to delete this product?\")){\r\n            cart.forEach((item, index) => {\r\n                if(item._id === id){\r\n                    cart.splice(index, 1)\r\n                }\r\n            })\r\n\r\n            setCart([...cart])\r\n            addToCart(cart)\r\n        }\r\n    }\r\n\r\n\r\n    const increment = (id) =>{\r\n        cart.forEach(item => {\r\n            if(item._id === id){\r\n                item.quantity += 1\r\n            }\r\n        })\r\n\r\n        setCart([...cart])\r\n        addToCart(cart)\r\n    }\r\n\r\n    const decrement = (id) =>{\r\n        cart.forEach(item => {\r\n            if(item._id === id){\r\n                item.quantity === 1 ? item.quantity = 1 : item.quantity -= 1\r\n            }\r\n        })\r\n\r\n        setCart([...cart])\r\n        addToCart(cart)\r\n    }\r\n    const tranSuccess = async (payment) => {\r\n        const {paymentID, address} = payment;\r\n\r\n        await axios.post('https://foodaa-app.herokuapp.com/api/payment/createPayments', {user:user, cart, paymentID, address}, {\r\n            headers: {Authorization: token}\r\n        })\r\n\r\n        setCart([])\r\n        addToCart([])\r\n        alert(\"You have successfully placed an order.\")\r\n    }\r\n    return (\r\n        <div className=\"w-4/5 m-auto mt-10 flex flex-col md:w-3/4 md:m-auto md:grid md:grid-cols-3 md:gap-4\">\r\n            {\r\n                isLogged ?\r\n                <>\r\n                    <div className=\"col-span-2  mt-4\">\r\n                    {\r\n                        cart.map(product => (\r\n                                \r\n                                <div key={product._id} className=\"bg-white-300 w-full h-72 mb-1 shadow-md rounded-md md:mb-2 md:grid md:grid-cols-4 md:h-36 md:w-full  md:col-span-1 \">\r\n                                    <div className=\" h-42 w-full \">\r\n                                        <img className=\"h-36 border-4 w-full border-black\" src={product.images.url} alt=\"\"/>\r\n                                    </div>\r\n                                    <div className=\" h-28 md:col-span-3 pl-5 flex flex-col overflow-hidden md:h-full\">\r\n                                        <div className=\" h-24 truncate mt-2\">\r\n                                            <h1 className=\"uppercase text-xl font-bold\">{product.title}</h1>\r\n                                            <h1 className=\"uppercase text-md font-semibold\">PHP {product.price}.00</h1>\r\n                                            <h1 className=\"uppercase text-xs \">{product.description}</h1>\r\n                                        </div>\r\n                                        <div className=\"h-10 flex items-center justify-between w-full md:mb-4\">\r\n                                            <div className=\" flex space-x-1 items-center\">\r\n                                                <span className=\"bg-white align-middle inline-block h-full px-2 cursor-pointer border-2 hover:border-black rounded-md\" onClick={() => increment(product._id)}> + </span>\r\n                                                <input className=\"w-10 m-auto focus:outline-none cursor-not-allowed border-2 text-right  \" type=\"number\" value={product.quantity} readOnly/>\r\n                                                <span className=\"bg-white align-middle inline-block h-full px-2 cursor-pointer border-2 hover:border-black rounded-md\"onClick={() => decrement(product._id)}> - </span>\r\n                                            </div>\r\n                                            <div className=\"mr-5\">\r\n                                                <button className=\"bg-red-400 p-2 uppercase text-sm  font-semibold tracking-wider rounded-sm hover:bg-gray-200 transition ease-out duration-200\" onClick={() => removeProduct(product._id)}>Remove</button>\r\n                                            </div>\r\n\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                \r\n                                \r\n                        ))\r\n                    }\r\n                    </div>\r\n                    <div className=\"bg-white w-full shadow-lg mt-4 h-48 mb-10 sticky grid grid-rows-4 md:h-64 rounded-xl\">\r\n                        <div className=\"flex justify-center items-center bg-gray-300 \">\r\n                            <h1 className=\"text-lg font-bold uppercase tracking-widest\">Order Summary</h1>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between m-10 bg-red-300 \">\r\n                            <span className=\"text-md tracking-wider font-semibold\">Subtotal Purchase :</span>\r\n                            <span className=\"text-lg font-bold\">PHP {total}.00</span>\r\n                        </div>\r\n                        <div className=\"flex items-center justify-between m-10 \">\r\n                            <span></span>\r\n                            <Payment\r\n                            total = {total}\r\n                            tranSuccess = {tranSuccess}\r\n                            />\r\n                        </div>\r\n                        \r\n                    </div>\r\n                </>\r\n                :\r\n                <div className=\" col-span-3 flex flex-col justify-center items-center w-full mt-56\">\r\n                    <span className=\"text-xl font-semibold tracking-widest\">Please Sign In to continue Shopping ...</span>\r\n                    <MdErrorOutline className=\"mt-10 text-9xl\"/>\r\n                </div>\r\n            }\r\n\r\n\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default Cart\r\n"]},"metadata":{},"sourceType":"module"}